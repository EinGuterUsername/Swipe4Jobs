<!DOCTYPE html>
<html lang="de">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Profile</title>
    <link rel="stylesheet" type="text/css" href="/profile.css" />
    <link rel="stylesheet"
        href="https://cdnjs.cloudflare.com/ajax/libs/MaterialDesign-Webfont/5.3.45/css/materialdesignicons.css"
        integrity="sha256-NAxhqDvtY0l4xn+YVa6WjAcmd94NNfttjNsDmNatFVc=" crossorigin="anonymous" />

</head>
<!---TODO https://www.bootdey.com/snippets/view/bs4-simple-chat-app Messenger einbauen-->
<div class="container">
    <div class="row">
        <div class="col-xl-5">
            <div class="card">
                <div class="card-body">
                    <div class="dropdown float-end"><a href="/settings"><i class="fa-solid fa-pen"></i></a>
                    </div>
                    <div class="d-flex align-items-start">
                        <img class="profilbild" src={{ userData.profilbild }} alt="Profilbild">
                        <div class="w-100 ms-3">
                            <h4 class="my-0">{{ userData.name }}</h4>
                            <p class="text-muted">{{ userData.userOption }}</p>
                            <button type="button" onclick="location.href='/messenger.hbs'"
                                class="btn btn-soft-success btn-xs waves-effect mb-2 waves-light" style="width: 70px"><i class="fas fa-envelope"></i></button>
                        </div>
                    </div>
                    <!--TODO Nicht/Vorhanden austauschen durch Dynamisches Feld das anzeigt ob datei hochgeladen wurde-->
                    <div class="mt-3">
                        <h4 class="font-13 text-uppercase">Bio:</h4>
                        <p id="bio-text" class="text-muted font-13 mb-3">{{ userData.bio }}</p>
                        <p class="text-muted mb-1 font-13"><strong>Location :</strong> <span
                                class="ms-2">{{userData.location }}</span></p>
                        <p class="text-muted mb-2 font-13"><strong>Lebenslauf:</strong>
                            <span class="ms-2" href="">
                                <span class="ms-2">Nicht/ Vorhanden</span>
                            </span>
                        </p>
                        <p class="text-muted mb-1 font-13"><strong>Skills :</strong>
                        <div id="skillsContainer"></div>
                    </div>
                    <form>
                        <input type="text" id="searchskill" placeholder="Suche nach Skills...">
                    </form>
                    <div id="searchskillResults"></div>
                    <!-- TODO Social Media links nur sichtbar, wenn etwas in den einstellungen dazu hinterlegt ist-->
                    <ul class="social-list list-inline mt-3 mb-0">
                        <li class="list-inline-item">
                            <a href="javascript: void(0);"
                                class="social-list-item text-center border-primary text-primary"><i
                                    class="mdi mdi-facebook"></i></a>
                        </li>
                        <li class="list-inline-item">
                            <a href="javascript: void(0);"
                                class="social-list-item text-center border-danger text-danger"><i
                                    class="mdi mdi-google"></i></a>
                        </li>
                        <li class="list-inline-item">
                            <a href="javascript: void(0);" class="social-list-item text-center border-info text-info"><i
                                    class="mdi mdi-twitter"></i></a>
                        </li>
                        <li class="list-inline-item">
                            <a href="javascript: void(0);"
                                class="social-list-item text-center border-secondary text-secondary"><i
                                    class="mdi mdi-github"></i></a>
                        </li>
                    </ul>
                </div>
            </div> <!-- end card -->

            <div class="card">
                <div class="card-body text-center">
                    <div class="row">

                        <div class="col-4 border-end border-light">
                            <h5 class="text-muted mt-1 mb-2 fw-normal">Neue Stellen</h5>
                            <h2 class="mb-0 fw-bold">116</h2>
                            <button type="button"
                                class="btn btn-soft-success btn-xs waves-effect mb-2 waves-light" style="width: 70px;"><i class="fa-solid fa-newspaper"></i></button>
                        </div>
                        <div class="col-4 border-end border-light">
                            <h5 class="text-muted mt-1 mb-2 fw-normal">Passende</h5>
                            <h2 class="mb-0 fw-bold">10</h2>
                            <button type="button"
                                class="btn btn-soft-success btn-xs waves-effect mb-2 waves-light" style="width: 70px;"><i class="fa-solid fa-handshake"></i></button>
                        </div>
                        <div class="col-4 border-end border-light">
                            <h5 class="text-muted mt-1 mb-2 fw-normal"></i>Matches</h5>
                            <h2 class="mb-0 fw-bold">3</h2>
                            <button type="button"
                                class="btn btn-soft-success btn-xs waves-effect mb-2 waves-light" style="width: 70px;"><i class="fas fa-envelope"></i></button>

                        </div>
                    </div>
                </div>
            </div>
            <div>
                <div>
                    <form>
                        <input type="text" id="searchInput" placeholder="Suche nach Benutzern...">
                    </form>
                    <div id="searchResults"></div>
                </div>
            </div>

            <div class="card">
                <div class="card-body">
                    <h4 class="header-title mb-3">Kontakte</h4>

                    <div class="inbox-widget" data-simplebar="init" style="max-height: 350px;">
                        <div style="margin: 0px;">
                            <div class="simplebar-height-auto-observer-wrapper">
                                <div class="simplebar-height-auto-observer"></div>
                            </div>
                            <div class="simplebar-mask">
                                <div>
                                    <ul class="contactlist">
                                        {{#each contacts}}
                                        <li class="contactitem "><img src="{{this.profilbild}}" alt="Bild"
                                                id="contactimg">{{this.name}} aus
                                            {{this.location}}<br>{{this.userOption}}
                                            <button action="/send_msg" type="submit" style="width: 50px;"
                                                class="sendmsgbtn" ><i class="fas fa-envelope"></i></button>
                                        </li>
                                        {{/each}}
                                    </ul>
                                </div>
                            </div>
                            <div class="simplebar-placeholder" style="width: auto; height: 532px;"></div>
                        </div>
                        <div class="simplebar-track simplebar-horizontal" style="visibility: hidden;">
                            <div class="simplebar-scrollbar" style="width: 0px; display: none;"></div>
                        </div>
                        <div class="simplebar-track simplebar-vertical" style="visibility: visible;">
                            <div class="simplebar-scrollbar"
                                style="height: 230px; transform: translate3d(0px, 0px, 0px); display: block;">
                            </div>
                        </div>
                    </div> <!-- end inbox-widget -->
                </div>
            </div><!-- end card-->


            <div class="card">
                <div class="card-body">
                    <div class="dropdown float-end">
                        <a href="#" class="dropdown-toggle arrow-none card-drop" data-bs-toggle="dropdown"
                            aria-expanded="false">
                            <i class="mdi mdi-dots-vertical"></i>
                        </a>
                        <div class="dropdown-menu dropdown-menu-end">
                            <!-- item-->
                            <a href="javascript:void(0);" class="dropdown-item">Sales Report</a>
                            <!-- item-->
                            <a href="javascript:void(0);" class="dropdown-item">Export Report</a>
                            <!-- item-->
                            <a href="javascript:void(0);" class="dropdown-item">Profit</a>
                            <!-- item-->
                            <a href="javascript:void(0);" class="dropdown-item">Action</a>
                        </div>
                    </div>

                    <h4 class="header-title mb-3">Upcoming Reminders <i class="mdi mdi-adjust ms-1"></i></h4>

                    <div class="list-group">
                        <a href="#" class="my-1">
                            <div class="d-flex align-items-start" id="tooltips-container">
                                <div class="">
                                    <i class="mdi mdi-circle h3 text-primary"></i>
                                </div>
                                <div class="w-100 ms-2">
                                    <h5 class="mb-1 mt-0">New Admin Layout Discuss</h5>
                                    <ul class="list-inline text-muted font-12">
                                        <li class="list-inline-item"><i
                                                class="mdi mdi-calendar-blank-outline me-1"></i>10 May 2021</li>
                                        <li class="list-inline-item"> - </li>
                                        <li class="list-inline-item"><i
                                                class="mdi mdi-clock-time-eight-outline me-1"></i>09:00am <span
                                                class="px-1">To</span> 10:30am</li>
                                    </ul>
                                </div>
                            </div>
                        </a>
                        <a href="#" class="my-1">
                            <div class="d-flex align-items-start" id="tooltips-container">
                                <div class="">
                                    <i class="mdi mdi-circle h3 text-pink"></i>
                                </div>
                                <div class="w-100 ms-2">
                                    <h5 class="mb-1 mt-0">Landing Pages Planning</h5>
                                    <ul class="list-inline text-muted font-12">
                                        <li class="list-inline-item"><i
                                                class="mdi mdi-calendar-blank-outline me-1"></i>10 May 2021</li>
                                        <li class="list-inline-item"> - </li>
                                        <li class="list-inline-item"><i
                                                class="mdi mdi-clock-time-eight-outline me-1"></i>02:00pm <span
                                                class="px-1">To</span> 4:00pm</li>
                                    </ul>
                                </div>
                            </div>
                        </a>
                        <a href="#" class="my-1">
                            <div class="d-flex align-items-start" id="tooltips-container">
                                <div class="">
                                    <i class="mdi mdi-circle h3 text-success"></i>
                                </div>
                                <div class="w-100 ms-2">
                                    <h5 class="mb-1 mt-0">Meet Our Clients</h5>
                                    <ul class="list-inline text-muted font-12">
                                        <li class="list-inline-item"><i
                                                class="mdi mdi-calendar-blank-outline me-1"></i>11 May 2021</li>
                                        <li class="list-inline-item"> - </li>
                                        <li class="list-inline-item"><i
                                                class="mdi mdi-clock-time-eight-outline me-1"></i>08:00am <span
                                                class="px-1">To</span> 11:20am</li>
                                    </ul>
                                </div>
                            </div>
                        </a>
                        <a href="#" class="my-1">
                            <div class="d-flex align-items-start" id="tooltips-container">
                                <div class="">
                                    <i class="mdi mdi-circle h3 text-warning"></i>
                                </div>
                                <div class="w-100 ms-2">
                                    <h5 class="mb-1 mt-0">Project Discussion</h5>
                                    <ul class="list-inline text-muted font-12">
                                        <li class="list-inline-item"><i
                                                class="mdi mdi-calendar-blank-outline me-1"></i>11 May 2021</li>
                                        <li class="list-inline-item"> - </li>
                                        <li class="list-inline-item"><i
                                                class="mdi mdi-clock-time-eight-outline me-1"></i>12:00am <span
                                                class="px-1">To</span> 03:00am</li>
                                    </ul>
                                </div>
                            </div>
                        </a>
                        <a href="#" class="my-1">
                            <div class="d-flex align-items-start" id="tooltips-container">
                                <div class="">
                                    <i class="mdi mdi-circle h3 text-dark"></i>
                                </div>
                                <div class="w-100 ms-2">
                                    <h5 class="mb-1 mt-0">Businees Meeting</h5>
                                    <ul class="list-inline text-muted font-12">
                                        <li class="list-inline-item"><i
                                                class="mdi mdi-calendar-blank-outline me-1"></i>12 May 2021</li>
                                        <li class="list-inline-item"> - </li>
                                        <li class="list-inline-item"><i
                                                class="mdi mdi-clock-time-eight-outline me-1"></i>08:30am <span
                                                class="px-1">To</span> 10:00am</li>
                                    </ul>
                                </div>
                            </div>
                        </a>

                    </div>
                </div>
            </div>
        </div> <!-- end col-->

        <div class="col-xl-7">
            <div class="card">
                <div class="card-body">
                    <!-- comment box -->
                    <form action="#" class="comment-area-box mb-3">
                        <span class="input-icon">
                            <textarea rows="3" class="form-control" placeholder="Write something..."></textarea>
                        </span>
                        <div class="comment-area-btn">
                            <div class="float-end">
                                <button type="submit" class="btn btn-sm btn-dark waves-effect waves-light">Post</button>
                            </div>
                            <div>
                                <a href="#" class="btn btn-sm btn-light text-black-50"><i class="far fa-user"></i></a>
                                <a href="#" class="btn btn-sm btn-light text-black-50"><i
                                        class="fa fa-map-marker-alt"></i></a>
                                <a href="#" class="btn btn-sm btn-light text-black-50"><i class="fa fa-camera"></i></a>
                                <a href="#" class="btn btn-sm btn-light text-black-50"><i class="far fa-smile"></i></a>
                            </div>
                        </div>
                    </form>
                    <!-- end comment box -->

                    <!-- Story Box-->
                    <div class="border border-light p-2 mb-3">
                        <div class="d-flex align-items-start">
                            <img class="me-2 avatar-sm rounded-circle"
                                src="https://bootdey.com/img/Content/avatar/avatar4.png"
                                alt="Generic placeholder image">
                            <div class="w-100">
                                <h5 class="">Thelma Fridley <small class="text-muted"> 1 hour ago</small></h5>
                                <div class="">
                                    Cras sit amet nibh libero, in
                                    gravida nulla. Nulla vel metus scelerisque ante sollicitudin. Cras
                                    purus odio, vestibulum in vulputate at, tempus viverra turpis. Duis
                                    sagittis ipsum. Praesent mauris. Fusce nec tellus sed augue semper
                                    porta. Mauris massa.
                                    <br>
                                    <a href="javascript: void(0);" class="text-muted font-13 d-inline-block mt-2"><i
                                            class="mdi mdi-reply"></i> Reply</a>
                                </div>
                            </div>

                        </div>


                        <div class="post-user-comment-box">
                            <div class="d-flex align-items-start">
                                <img class="me-2 avatar-sm rounded-circle"
                                    src="https://bootdey.com/img/Content/avatar/avatar3.png"
                                    alt="Generic placeholder image">
                                <div class="w-100">
                                    <h5 class="mt-0">Jeremy Tomlinson <small class="text-muted">3 hours ago</small></h5>
                                    Nice work, makes me think of The Money Pit.

                                    <br>
                                    <a href="javascript: void(0);" class="text-muted font-13 d-inline-block mt-2"><i
                                            class="mdi mdi-reply"></i> Reply</a>

                                    <div class="d-flex align-items-start mt-3">
                                        <a class="pe-2" href="#">
                                            <img src="https://bootdey.com/img/Content/avatar/avatar4.png"
                                                class="avatar-sm rounded-circle" alt="Generic placeholder image">
                                        </a>
                                        <div class="w-100">
                                            <h5 class="mt-0">Kathleen Thomas <small class="text-muted">5 hours
                                                    ago</small></h5>
                                            i'm in the middle of a timelapse animation myself! (Very different though.)
                                            Awesome stuff.
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <div class="d-flex align-items-start mt-2">
                                <a class="pe-2" href="#">
                                    <img src="https://bootdey.com/img/Content/avatar/avatar1.png" class="rounded-circle"
                                        alt="Generic placeholder image" height="31">
                                </a>
                                <div class="w-100">
                                    <input type="text" id="simpleinput" class="form-control border-0 form-control-sm"
                                        placeholder="Add comment">
                                </div>
                            </div>
                        </div>

                        <div class="mt-2">
                            <a href="javascript: void(0);" class="btn btn-sm btn-link text-danger"><i
                                    class="mdi mdi-heart"></i> Like (28)</a>
                            <a href="javascript: void(0);" class="btn btn-sm btn-link text-muted"><i
                                    class="mdi mdi-share-variant"></i> Share</a>
                        </div>
                    </div>

                    <!-- Story Box-->
                    <div class="border border-light p-2 mb-3">
                        <div class="d-flex align-items-start">
                            <img class="me-2 avatar-sm rounded-circle"
                                src="https://bootdey.com/img/Content/avatar/avatar3.png"
                                alt="Generic placeholder image">
                            <div class="w-100">
                                <h5 class="m-0">Jeremy Tomlinson</h5>
                                <p class="text-muted"><small>about 2 minuts ago</small></p>
                            </div>
                        </div>
                        <p>Story based around the idea of time lapse, animation to post soon!</p>

                        <img src="https://www.bootdey.com/image/800x540/FF7F50/000000" alt="post-img"
                            class="rounded me-1" height="60">
                        <img src="https://www.bootdey.com/image/800x540/FF7F50/000000" alt="post-img"
                            class="rounded me-1" height="60">
                        <img src="https://www.bootdey.com/image/800x540/FF7F50/000000" alt="post-img" class="rounded"
                            height="60">

                        <div class="mt-2">
                            <a href="javascript: void(0);" class="btn btn-sm btn-link text-muted"><i
                                    class="mdi mdi-reply"></i> Reply</a>
                            <a href="javascript: void(0);" class="btn btn-sm btn-link text-muted"><i
                                    class="mdi mdi-heart-outline"></i> Like</a>
                            <a href="javascript: void(0);" class="btn btn-sm btn-link text-muted"><i
                                    class="mdi mdi-share-variant"></i> Share</a>
                        </div>
                    </div>

                    <!-- Story Box-->
                    <div class="border border-light p-2 mb-3">
                        <div class="d-flex align-items-start">
                            <img class="me-2 avatar-sm rounded-circle"
                                src="https://bootdey.com/img/Content/avatar/avatar6.png"
                                alt="Generic placeholder image">
                            <div class="w-100">
                                <h5 class="m-0">Jeremy Tomlinson</h5>
                                <p class="text-muted"><small>15 hours ago</small></p>
                            </div>
                        </div>
                        <p>The parallax is a little odd but O.o that house build is awesome!!</p>
                    </div>

                    <div class="text-center">
                        <a href="javascript:void(0);" class="text-danger"><i class="mdi mdi-spin mdi-loading me-1"></i>
                            Load more </a>
                    </div>
                </div>
            </div> <!-- end card-->

        </div> <!-- end col -->
    </div>
    <!-- end row-->
<script>
    const searchInput = document.getElementById("searchInput");
    const searchResultsContainer = document.getElementById("searchResults");

    searchInput.addEventListener("input", () => {
        const query = searchInput.value;

        // Überprüfen, ob die Länge der Eingabe mindestens 3 ist
        if (query.length >= 3) {
            searchResults.style.display = "block";
            fetch(`/suche?query=${query}`)
                .then(response => response.json())
                .then(searchResults => {
                    // Lösche vorherige Suchergebnisse
                    searchResultsContainer.innerHTML = "";
                    // Anzeigen der Suchergebnisse
                    searchResults.forEach(user => {
                        const userProfileContainer = document.createElement("div");
                        const userProfileLink = document.createElement("a");
                        userProfileLink.href = `/profile/${user.userId}`;
                        userProfileLink.style.textDecoration = "none";
                        userProfileLink.textContent = `${user.name} aus ${user.location}`;
                        userProfileLink.style.color = "black";
                        userProfileLink.style.marginTop= "3px";
                        userProfileLink.style.marginLeft= "3px";
                        userProfileLink.style.marginRight = "10px";
                        userProfileLink.style.marginBottom = "10px";
                        const addButton = document.createElement("button");
                        addButton.innerHTML = '<i class="fa-solid fa-user-plus"></i>';
                        addButton.style.marginRight = "10px"; // Horizontaler Abstand
                        addButton.style.marginBottom = "10px"; // Vertikaler Abstand
                        addButton.style.border = "solid 1px rgba(128, 128, 128, 0.5)";
                        addButton.style.boxShadow = "2px 2px 2px rgba(128, 128, 128, 0.2) inset";
                        addButton.style.width = "50px";
                        addButton.style.float = "right";
                        addButton.style.backgroundColor = "#ffffff"
                        addButton.style.textAlign = "center";
                        addButton.addEventListener("mouseover", () => {
                        addButton.style.backgroundColor = "#f0f0f0"; // Ändert die Hintergrundfarbe bei Hover
                        });
                        addButton.addEventListener("mouseout", () => {
                        addButton.style.backgroundColor = "transparent"; // Setzt die Hintergrundfarbe zurück, wenn der Mauszeiger das Element verlässt
                        });
                        addButton.addEventListener("click", () => {
                            fetch(`/add-contact/${user.userId}`, {
                                method: "POST",
                                headers: {
                                    "Content-Type": "application/json"
                                }
                            })
                                .then(response => {
                                    if (response.ok) {
                                        console.log("Kontakt erfolgreich hinzugefügt");
                                        addButton.style.display = "none"; // Verstecken Sie den Button nach dem Hinzufügen
                                    } else {
                                        console.error("Fehler beim Hinzufügen des Kontakts:", response.statusText);
                                    }
                                })
                                .catch(error => console.error("Fehler beim Hinzufügen des Kontakts:", error));
                        });
                        const contactManagerButton = document.createElement("button");
                        contactManagerButton.style.marginRight = "10px"; // Horizontaler Abstand
                        contactManagerButton.style.marginBottom = "10px"; // Vertikaler Abstand
                        contactManagerButton.style.border = "solid 1px rgba(128, 128, 128, 0.5)";
                        contactManagerButton.style.width = "50px";
                        contactManagerButton.style.textAlign = "center";
                        contactManagerButton.innerHTML = '<i class="fas fa-envelope"></i>';
                        contactManagerButton.style.float = "right";
                        contactManagerButton.style.boxShadow = "2px 2px 2px rgba(128, 128, 128, 0.2) inset";
                        contactManagerButton.style.backgroundColor = "#ffffff"
                        contactManagerButton.addEventListener("mouseover", () => {
                        contactManagerButton.style.backgroundColor = "#f0f0f0"; // Ändert die Hintergrundfarbe bei Hover
                        });
                        contactManagerButton.addEventListener("mouseout", () => {
                        contactManagerButton.style.backgroundColor = "transparent"; // Setzt die Hintergrundfarbe zurück, wenn der Mauszeiger das Element verlässt
                        });
                        contactManagerButton.addEventListener("click", () => {
                            // Hier die Logik implementieren, um zum Kontaktmanager zu wechseln
                            // Z.B. Weiterleitung zur Kontaktmanager-Seite
                            window.location.href = "/write";
                        });
                        userProfileContainer.appendChild(userProfileLink);
                        userProfileContainer.appendChild(addButton);
                        userProfileContainer.appendChild(contactManagerButton);
                        searchResultsContainer.appendChild(userProfileContainer);
                        searchResultsContainer.appendChild(document.createElement("br"));
                    });
                })
                .catch(error => console.error("Fehler beim Abrufen der Suchergebnisse:", error));
        } else {
            searchResults.style.display = "none";
            // Wenn die Länge der Eingabe weniger als 3 ist, löschen Sie die Suchergebnisse
            searchResultsContainer.innerHTML = "";
        }
    });
</script>
<script>
    const searchskillInput = document.getElementById("searchskill");
    const searchskillResultsContainer = document.getElementById("searchskillResults");
    let userId; // Variable für die Benutzer-ID

    searchskillInput.addEventListener("input", () => {
        const query = searchskillInput.value;

        // Überprüfen, ob die Länge der Eingabe mindestens 1 ist
        if (query.length >= 1) {
            searchskillResults.style.display = "block";
            fetch("/searchSkill", {
                method: "POST",
                headers: {
                    "Content-Type": "application/json"
                },
                body: JSON.stringify({ query: query }) // Die Suchanfrage im JSON-Format senden
            })
                .then(response => response.json())
                .then(searchskill => {
                    // Lösche vorherige Suchergebnisse
                    searchskillResultsContainer.innerHTML = "";
                    // Anzeigen der Suchergebnisse
                    searchskill.forEach(skill => {
                        const skillElement = document.createElement("div");

                        skillElement.textContent = skill.skill;
                        skillElement.classList.add("skill");
                        skillElement.dataset.skillId = skill.skillId;
                        skillElement.style.background="#ffffff";
                        skillElement.style.border="none"
                        skillElement.style.boxShadow = "2px 2px 2px rgba(128, 128, 128, 0.2) inset";
                        searchskillResultsContainer.appendChild(skillElement);
                        const addSkillButton = document.createElement("button");
                        addSkillButton.textContent = "+";
                        addSkillButton.style.marginRight = "10px"; // Horizontaler Abstand
                        addSkillButton.style.marginBottom = "10px"; // Vertikaler Abstand
                        addSkillButton.style.border = "solid 1px rgba(128, 128, 128, 0.5)";
                        addSkillButton.style.width = "50px";
                        addSkillButton.style.textAlign = "center";
                        addSkillButton.style.float="right";
                        addSkillButton.style.boxShadow = "2px 2px 2px rgba(128, 128, 128, 0.2) inset";
                        addSkillButton.style.backgroundColor = "#ffffff";
                        addSkillButton.classList.add("addskillbutton");
                        addSkillButton.addEventListener("mouseover", () => {
                        addSkillButton.style.backgroundColor = "#f0f0f0"; // Ändert die Hintergrundfarbe bei Hover
                        });
                        addSkillButton.addEventListener("mouseout", () => {
                        addSkillButton.style.backgroundColor = "transparent"; // Setzt die Hintergrundfarbe zurück, wenn der Mauszeiger das Element verlässt
                        });
                        addSkillButton.addEventListener("click", () => {
                            const skillId = skill.skillId; // ID des ausgewählten Skills
                            // Hier den Skill hinzufügen und die Benutzer-ID übergeben
                            addSkillToUser(userId, skillId);
                        });
                        skillElement.appendChild(addSkillButton);
                    });
                })
                .catch(error => console.error("Fehler beim Abrufen der Suchergebnisse:", error));
        } else {
            searchskillResults.style.display = "none";
            searchskillResultsContainer.innerHTML = "";
        }
    });

    function fetchUserId() {
        console.log("userId fetching")
        fetch("/getUserId")
            .then(response => {
                if (response.ok) {
                    return response.json();
                } else {
                    throw new Error("Fehler beim Abrufen der userId");
                }
            })
            .then(data => {
                userId = data.userId; // Die userId aus den empfangenen Daten zuweisen
                console.log("Die userId ist:", userId);
            })
            .catch(error => {
                console.error("Fehler beim Abrufen der userId:", error);
            });
    };

    function addSkillToUser(userId, skillId) {
        fetch("/addSkillToUser", {
            method: "POST",
            headers: {
                "Content-Type": "application/json"
            },
            body: JSON.stringify({ userId: userId, skillId: skillId }) // Benutzer-ID und Skill-ID senden
        })
            .then(response => {
                if (response.ok) {
                    console.log("Skill erfolgreich hinzugefügt");
                } else {
                    console.error("Fehler beim Hinzufügen des Skills:", response.statusText);
                }loadAndDisplaySkills();
            })
            .catch(error => console.error("Fehler beim Hinzufügen des Skills:", error));
    }
    function loadAndDisplaySkills() {
        fetch("/loadskills")
            .then(response => response.json())
            .then(skills => {
                const skillsContainer = document.getElementById("skillsContainer");
                skillsContainer.innerHTML = ""; // Leeren Sie zuerst den Container
                skills.forEach(skill => {
                    const skillElement = document.createElement("div");
                    skillElement.textContent = skill;
                    skillElement.dataset.skillId = skill.Id;
                    skillElement.classList.add("skill");
                    skillElement.style.cursor = "pointer";
                    skillElement.style.transition = "background-color 0.3s";
                    skillElement.style.marginBottom = "3px";
                    skillElement.style.marginRight = "3px";
                    skillElement.style.marginLeft = "3px";
                    skillElement.style.border = "2px solid #ccc";
                    skillElement.style.padding = "3px";
                    skillElement.style.borderRadius = "5px";
                    skillElement.style.boxShadow = "2px 2px 2px rgba(128, 128, 128, 0.2) inset";
                    skillElement.style.backgroundColor = "#ffffff";
                    skillElement.addEventListener("mouseover", () => {
                        skillElement.style.backgroundColor = "#f0f0f0"; // Ändert die Hintergrundfarbe bei Hover
                    });
                    skillElement.addEventListener("mouseout", () => {
                        skillElement.style.backgroundColor = "transparent"; // Setzt die Hintergrundfarbe zurück, wenn der Mauszeiger das Element verlässt
                    });
                    skillsContainer.appendChild(skillElement);
                });
                setupSkillDeletionListeners();
            })
            .catch(error => console.error("Fehler beim Laden der Skills:", error));
    }
 document.addEventListener("DOMContentLoaded", function () {
        fetchUserId();
        loadAndDisplaySkills();
        console.log("DOM 1 vollständig geladen");
    });
function deleteSkill(userId, skill) {
    console.log("deleteSkill wird ausgeführt");
    console.log("UserID:", userId);
    console.log("Skill:", skill);
    
    fetch(`/deleteSkill`, {
        method: "POST",
        headers: {
            "Content-Type": "application/json"
        },
        body: JSON.stringify({ userId: userId, skill: skill })
    })
    .then(response => {
        console.log("Response vom Server:", response);
        if (response.ok) {
            console.log("Skill erfolgreich gelöscht");
        } else {
            console.error("Fehler beim Löschen des Skills:", response.statusText);
        }
    })
    .catch(error => console.error("Fehler beim Löschen des Skills:", error));
}

    function setupSkillDeletionListeners() {
        console.log("setupSkillDeletionListeners wurde ausgeführt")
        document.querySelectorAll('.skill').forEach(skillElement => {
            skillElement.addEventListener('click', () => {
                const skill = skillElement.textContent; // Hole die Skill-ID aus dem Dataset
                console.log("Gelöscht im Frondend!")
                console.log(skill)
                // Rufe die Funktion zum Löschen des Skills auf
                deleteSkill(userId, skill);
                // Entferne das Skill-Element aus der Anzeige
                skillElement.remove();
            });
        });
    }
</script>
    <script src="https://kit.fontawesome.com/aedcf8330f.js" crossorigin="anonymous"></script>
    <script src="/bootstrap.min.css"></script>
    <script src="/jquery-3.7.1.js"></script>
    <script src="/nav.js"></script>
</div>


</html>